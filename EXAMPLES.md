# üîß –ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞

–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

## 1Ô∏è‚É£ –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ

### –í–∞—Ä–∏–∞–Ω—Ç A: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±** - –¥–æ–±–∞–≤—å—Ç–µ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É –ø–µ—Ä–µ–¥ `</body>`:

```html
<!DOCTYPE html>
<html>
<head>
    <title>–ü—Ä–∞–≤–∏–ª–∞</title>
</head>
<body>
    <!-- –í–∞—à–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∑–¥–µ—Å—å -->
    <main>
        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω —Å—é–¥–∞ -->
    </main>

    <!-- –ü–æ–¥—É–≥—Ä—É–∂–∞–µ–º —Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ -->
    <script src="/content-manager.js"></script>
</body>
</html>
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- ‚úì –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–∑ URL
- ‚úì –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–Ω—Ç –∏–∑ –ë–î
- ‚úì –ó–∞–º–µ–Ω—è–µ—Ç—Å—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `<main>` –∏–ª–∏ `#dynamic-content`
- ‚úì –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (`<title>`)

### –í–∞—Ä–∏–∞–Ω—Ç B: –†—É—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

```html
<!DOCTYPE html>
<html>
<head>
    <title>–ú–æ—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</title>
</head>
<body>
    <div id="my-content">–ó–∞–≥—Ä—É–∂–∞—é –∫–æ–Ω—Ç–µ–Ω—Ç...</div>

    <script src="/content-manager.js"></script>
    <script>
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        pageContentManager.loadPageContent('about');
        
        // –ò–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
        pageContentManager.loadContentIntoElement('my-content', 'about');
    </script>
</body>
</html>
```

---

## 2Ô∏è‚É£ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞

### –ü—Ä–æ—Å—Ç–∞—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

```html
<!DOCTYPE html>
<html>
<head>
    <title>–ê–¥–º–∏–Ω - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        .page-list { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .page-card { border: 1px solid #ddd; padding: 15px; border-radius: 8px; }
        button { padding: 8px 16px; background: #5D8C30; color: white; border: none; border-radius: 4px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>üìñ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º</h1>
    <div class="page-list" id="pages"></div>

    <script src="/content-manager.js"></script>
    <script src="/content-editor.js"></script>
    <script>
        const editor = new ContentEditor({ isAdmin: true });

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü
        async function loadPages() {
            const pages = await editor.getAllPages();
            
            const html = pages.map(page => `
                <div class="page-card">
                    <h3>${page.page_name}</h3>
                    <p>–í–µ—Ä—Å–∏—è: ${page.version}</p>
                    <p>–û–±–Ω–æ–≤–ª–µ–Ω–∞: ${new Date(page.updated_at).toLocaleDateString('ru-RU')}</p>
                    <button onclick="editPage('${page.page_name}')">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
            `).join('');
            
            document.getElementById('pages').innerHTML = html;
        }

        async function editPage(pageName) {
            const data = await editor.getPageForEditing(pageName);
            const newContent = prompt('–ù–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç:', data.content.substring(0, 100) + '...');
            
            if (newContent) {
                await editor.savePageContent(pageName, {
                    title: data.title,
                    content: newContent
                });
                alert('‚úì –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!');
                loadPages();
            }
        }

        loadPages();
    </script>
</body>
</html>
```

---

## 3Ô∏è‚É£ WYSIWYG —Ä–µ–¥–∞–∫—Ç–æ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### –° –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º TinyMCE

```html
<!DOCTYPE html>
<html>
<head>
    <title>–†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞</title>
    <!-- TinyMCE —Ä–µ–¥–∞–∫—Ç–æ—Ä -->
    <script src="https://cdn.tiny.cloud/1/YOUR_API_KEY/tinymce/6/tinymce.min.js"></script>
</head>
<body>
    <h1>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã</h1>
    
    <form id="editor-form">
        <div>
            <label>–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
            <input type="text" id="page-title" required>
        </div>

        <div>
            <label>–ö–æ–Ω—Ç–µ–Ω—Ç:</label>
            <textarea id="page-content" required></textarea>
        </div>

        <button type="button" onclick="savePage()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </form>

    <script src="/content-editor.js"></script>
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å TinyMCE
        tinymce.init({
            selector: '#page-content',
            plugins: 'link image lists code',
            toolbar: 'undo redo | bold italic | link image | bullist numlist | code'
        });

        const editor = new ContentEditor({ isAdmin: true });
        const currentPageName = new URLSearchParams(window.location.search).get('page');

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç
        async function loadPage() {
            if (!currentPageName) return;
            
            const data = await editor.getPageForEditing(currentPageName);
            document.getElementById('page-title').value = data.title || '';
            tinymce.get('page-content').setContent(data.content);
        }

        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç
        async function savePage() {
            const title = document.getElementById('page-title').value;
            const content = tinymce.get('page-content').getContent();

            const result = await editor.savePageContent(currentPageName, { title, content });
            
            if (result) {
                alert('‚úì –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!');
            } else {
                alert('‚úó –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏!');
            }
        }

        loadPage();
    </script>
</body>
</html>
```

---

## 4Ô∏è‚É£ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### React hook –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

```javascript
// usePageContent.js - Custom hook
import { useState, useEffect } from 'react';

export function usePageContent(pageName) {
  const [content, setContent] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  useEffect(() => {
    const fetchContent = async () => {
      try {
        const response = await fetch(`/api/content/${pageName}`);
        if (!response.ok) throw new Error('–ö–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω');
        
        const data = await response.json();
        setContent(data.data);
      } catch (err) {
        setError(err.message);
      } finally {
        setLoading(false);
      }
    };

    fetchContent();
  }, [pageName]);

  return { content, loading, error };
}

// –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
function PageContent({ pageName }) {
  const { content, loading, error } = usePageContent(pageName);

  if (loading) return <div>–ó–∞–≥—Ä—É–∑–∫–∞...</div>;
  if (error) return <div>–û—à–∏–±–∫–∞: {error}</div>;

  return (
    <div>
      <h1>{content?.title}</h1>
      <div dangerouslySetInnerHTML={{ __html: content?.content }} />
    </div>
  );
}

export default PageContent;
```

### React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

```javascript
// AdminPanel.jsx
import React, { useState, useEffect } from 'react';

function AdminPanel() {
  const [pages, setPages] = useState([]);
  const [selectedPage, setSelectedPage] = useState(null);
  const [editing, setEditing] = useState(false);

  useEffect(() => {
    loadPages();
  }, []);

  const loadPages = async () => {
    const token = localStorage.getItem('token');
    const response = await fetch('/api/content/admin/all', {
      headers: { 'Authorization': `Bearer ${token}` }
    });
    const data = await response.json();
    setPages(data.data);
  };

  const handleSave = async (newContent) => {
    const token = localStorage.getItem('token');
    const response = await fetch(`/api/content/${selectedPage.page_name}`, {
      method: 'PUT',
      headers: {
        'Authorization': `Bearer ${token}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(newContent)
    });

    if (response.ok) {
      alert('‚úì –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!');
      setEditing(false);
      loadPages();
    }
  };

  return (
    <div>
      <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º</h1>
      <div className="pages-list">
        {pages.map(page => (
          <div key={page.id} className="page-card">
            <h3>{page.page_name}</h3>
            <button onClick={() => {
              setSelectedPage(page);
              setEditing(true);
            }}>
              –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
            </button>
          </div>
        ))}
      </div>

      {editing && selectedPage && (
        <Editor 
          page={selectedPage} 
          onSave={handleSave}
          onCancel={() => setEditing(false)}
        />
      )}
    </div>
  );
}

export default AdminPanel;
```

---

## 5Ô∏è‚É£ Vue.js –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### Vue 3 composable

```javascript
// usePageContent.js
import { ref, onMounted } from 'vue';

export function usePageContent(pageName) {
  const content = ref(null);
  const loading = ref(true);
  const error = ref(null);

  const fetchContent = async () => {
    try {
      const response = await fetch(`/api/content/${pageName}`);
      if (!response.ok) throw new Error('–ö–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω');
      
      const data = await response.json();
      content.value = data.data;
    } catch (err) {
      error.value = err.message;
    } finally {
      loading.value = false;
    }
  };

  onMounted(() => fetchContent());

  return { content, loading, error, refetch: fetchContent };
}
```

### Vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

```vue
<!-- PageView.vue -->
<template>
  <div>
    <div v-if="loading" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    <div v-else-if="error" class="error">{{ error }}</div>
    <div v-else>
      <h1>{{ content?.title }}</h1>
      <div v-html="content?.content"></div>
    </div>
  </div>
</template>

<script setup>
import { computed } from 'vue';
import { usePageContent } from '@/composables/usePageContent';

const props = defineProps({
  pageName: String
});

const { content, loading, error } = usePageContent(
  computed(() => props.pageName)
);
</script>
```

---

## 6Ô∏è‚É£ –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (i18n)

### –° –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π vue-i18n

```javascript
// –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –µ–≥–æ –≤ i18n
async function loadLocalizedContent() {
  const pages = await Promise.all([
    fetch('/api/content/rules-ru').then(r => r.json()),
    fetch('/api/content/rules-en').then(r => r.json()),
  ]);

  const messages = {
    ru: { page: { rules: pages[0].data.content } },
    en: { page: { rules: pages[1].data.content } }
  };

  i18n.global.setLocaleMessage('ru', messages.ru);
  i18n.global.setLocaleMessage('en', messages.en);
}
```

---

## 7Ô∏è‚É£ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### IndexedDB –∫—ç—à

```javascript
// cache-manager.js
const DB_NAME = 'SiteEMBCache';
const STORE_NAME = 'pages';

export class CacheManager {
  async init() {
    return new Promise((resolve, reject) => {
      const request = indexedDB.open(DB_NAME, 1);
      
      request.onupgradeneeded = (e) => {
        const db = e.target.result;
        if (!db.objectStoreNames.contains(STORE_NAME)) {
          db.createObjectStore(STORE_NAME);
        }
      };
      
      request.onsuccess = () => resolve(request.result);
      request.onerror = () => reject(request.error);
    });
  }

  async getPage(pageName) {
    const db = await this.init();
    return new Promise((resolve) => {
      const tx = db.transaction(STORE_NAME);
      const store = tx.objectStore(STORE_NAME);
      const request = store.get(pageName);
      
      request.onsuccess = () => resolve(request.result);
    });
  }

  async savePage(pageName, data) {
    const db = await this.init();
    return new Promise((resolve) => {
      const tx = db.transaction(STORE_NAME, 'readwrite');
      const store = tx.objectStore(STORE_NAME);
      
      store.put({
        ...data,
        cachedAt: Date.now()
      }, pageName);
      
      tx.oncomplete = () => resolve(true);
    });
  }

  async clearOldCache(maxAgeDays = 7) {
    const db = await this.init();
    const maxAge = maxAgeDays * 24 * 60 * 60 * 1000;
    const now = Date.now();

    const tx = db.transaction(STORE_NAME, 'readwrite');
    const store = tx.objectStore(STORE_NAME);
    const request = store.getAll();

    request.onsuccess = () => {
      request.result.forEach((item, key) => {
        if (now - item.cachedAt > maxAge) {
          store.delete(key);
        }
      });
    };
  }
}
```

---

## üìù –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

1. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**
   ```javascript
   // –ü–µ—Ä–≤—ã–π —Ä–∞–∑ –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ –ë–î, –ø–æ—Ç–æ–º –∏–∑ –∫—ç—à–∞
   const content = pageContentManager.getCachedContent('rules')
     || await pageContentManager.loadPageContent('rules');
   ```

2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
   ```javascript
   try {
     await pageContentManager.loadPageContent('page');
   } catch (error) {
     console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç:', error);
     // –ü–æ–∫–∞–∑–∞—Ç—å fallback –∫–æ–Ω—Ç–µ–Ω—Ç –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
   }
   ```

3. **–ò–∑–æ–ª—è—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞**
   ```javascript
   // –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
   <div id="dynamic-content"></div>
   
   pageContentManager.loadContentIntoElement('dynamic-content', 'rules');
   ```

4. **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π**
   ```javascript
   // –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≤–µ—Ä—Å–∏—é –∫–æ–Ω—Ç–µ–Ω—Ç–∞
   const latestContent = await pageContentManager.loadPageContent('rules');
   if (latestContent.version > currentVersion) {
     console.log('‚úì –ö–æ–Ω—Ç–µ–Ω—Ç –æ–±–Ω–æ–≤–ª–µ–Ω');
   }
   ```

---

## üîó –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](./API-DOCS.md)
- [–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ](./CONTENT-SYSTEM.md)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](./QUICKSTART.md)
